<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Typing App</title>
  </head>
  <style>
    .typing-grid {
      display: grid;
      justify-content: center;
      align-content: center;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
    }

    .typing-grid > button {
      font-size: 5rem;
      background-color: rgb(56, 82, 174);
    }
    body {
      display: grid;
      justify-content: center;
    }

    .result_Div {
      font-size: 2rem;
    }

    .game-over {
      font-size: 2rem;
      background-color: rgb(174, 56, 156);
    }
  </style>
  <body>
    <div class="typing-grid">
      <button class="typing-grid-btn" id="btn1">!!</button>
      <button class="typing-grid-btn" id="btn2">b</button>
      <button class="typing-grid-btn" id="btn3">c</button>
      <!-- <button class="typing-grid-btn" id="btn4">3</button>
      <button class="typing-grid-btn" id="btn5">3</button>
      <button class="typing-grid-btn" id="btn6">3</button>
      <button class="typing-grid-btn" id="btn7">3</button>
      <button class="typing-grid-btn" id="btn8">3</button>
      <button class="typing-grid-btn" id="btn9">3</button> -->
    </div>

    <div class="result_Div">
      <div id="correctKey_Count_Div">correctKey_Count_Div</div>
      <div id="wrongKey_Count_Div">wrongKey_Count_Div</div>
      <div id="score_Div">Score</div>
    </div>

    <div class="game-over" id="game-over"></div>

    <script>
      document.addEventListener("DOMContentLoaded", keyInput);
      document.addEventListener("DOMContentLoaded", getKeyInput);

      //random number
      function getRandomInt(max) {
        return Math.floor(Math.random() * max);
      }
      //keyboardInput
      function keyInput() {
        document.body.addEventListener("keydown", getKeyInput);
      }

      let correctKey_Count = 0;
      let wrongKey_Count = 0;
      let score = 0;
      let global_generateText;
      let global_gameOver_Check;
      let global_empty_btn_Check;

      function allBtn_func() {
        let allBtn = document.querySelectorAll(".typing-grid-btn");
        return allBtn;
      }

      function getKeyInput(ev) {
        let char = ev.key;
        let allBtn = allBtn_func();

        // allBtn.forEach(x => console.log(`allBtn${x.innerHTML}`));
        // console.log(char);
        // console.log(document.querySelector(".typing-grid-btn").innerHTML);
        // let result=document.getElementById("result").innerHTML;

        for (let eachBtn of allBtn) {
          if (eachBtn.innerHTML === char) {
            score++;
            console.log(score);
            document.getElementById("score_Div").innerHTML = `SCORE: ${score}`;
          }
        }

        let allBtnArr = [];
        allBtn.forEach(btn => allBtnArr.push(btn.innerHTML));
        if (allBtnArr.includes(char)) {
          correctKey_Count++;
          console.log(correctKey_Count);
          document.getElementById(
            "correctKey_Count_Div"
          ).innerHTML = `correctKey_Count: ${correctKey_Count}`;
        } else {
          wrongKey_Count++;
          console.log(wrongKey_Count);
          document.getElementById(
            "wrongKey_Count_Div"
          ).innerHTML = `wrongKey_Count: ${wrongKey_Count}`;
        }

        let abcArr = ["a", "b", "c"];

        //empty_btn_Check
        // function empty_btn_Check(){
        // let empty_btn_Check_Arr =[]
        // allBtn.forEach(x =>{if(document.getElementById(x).innerHTML = "!!"){empty_btn_Check_Arr.push(x.innerHTML)} })
        // console.log("empty btn:"+empty_btn_Check_Arr);
        // }
        //generate text
        function generateText() {
          if ((document.getElementById("btn1").innerHTML = "!!")) {
            document.getElementById("btn1").innerHTML = abcArr[getRandomInt(3)];
            console.log("btn1 working= " + abcArr[getRandomInt(3)]);
          }
        }
        //gameOver_Check
        function gameOver_Check() {
          let allBtnArrUpdate = [];
          allBtn.forEach(x => allBtnArrUpdate.push(x.innerHTML));
          console.log(allBtnArrUpdate);

          let allFilled;
          if (allBtnArrUpdate.includes("!!")) {
            allFilled = false;
          } else {
            allFilled = true;
          }

          console.log("allFilled" + allFilled);
          if (allFilled === true) {
            document.getElementById("game-over").innerHTML = "Game Over";
            return allFilled;
          }
        }
        global_generateText = generateText;
        global_gameOver_Check = gameOver_Check;
        // global_empty_btn_Check=empty_btn_Check
      }

      //start btn, run setInterval
      document.addEventListener("DOMContentLoaded", startBtn);

      let set_generateText;
      let set_gameOver_Check;
      let startGame;
      let set_empty_btn_Check;
      function startBtn() {
        set_generateText = setInterval(global_generateText, 2000);
        set_gameOver_Check = setInterval(global_gameOver_Check, 2000);
        // set_empty_btn_Check = setInterval(global_empty_btn_Check, 2000);
        //startGame = setInterval(startBtn,2000);
      }

      if (global_gameOver_Check) {
        //clearInterval(startGame);
        clearInterval(set_gameOver_Check);
        //clearInterval(set_empty_btn_Check);
        clearInterval(set_generateText);

        console.log("gameOverTrue working");
      }

      // console.log(gameOverTrue);

      // add accuratcy stat
      // add typespeed meter, increasing level, rainbow
    </script>
  </body>
</html>
